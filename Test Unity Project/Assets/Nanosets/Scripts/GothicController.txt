Контроллер персонажа Gothic
===========================

В игре Gothic (разработанной студией Piranha Bytes), в первой её части был свой
оригинальный контроллер персонажа (в последующих частях Готики управление было
изменено на более классическое). Здесь я пытаюсь воспроизвести этот контроллер
насколько я его помню, при этом возможно какие-то моменты я всё-таки изменю -
моя цель с одной стороны передать ощущения от той системы боя, с другой стороны
по возможности упростить управление и сделать его более лёгким и приятным.

Чем же отличается управление в Готике? Любое действие, в том числе в бою
совершалось нажатием комбинации клавиш «Действие» + «Движение». Меня в первую
очередь интересует система боя. В бою (мечом), управление происходило примерно
так: вы зажимаете левую кнопку мыши (клавиша «Действие») и тем самым переходите
в режим атаки, но реальные атаки совершаются при нажатии клавиш движения (WSAD).
В зависимости от нажатой клавиши выполнялись разные типы атак. Если нажать A
(«влево»), то персонаж бил мечом справа налево, если нажать D («вправо»), то
персонаж бил мечом слева направо. Нажимая последовательно «вправо», «влево»,
«вправо», «влево» и т.д. складывалось мини-комбо, назовем его «горизонтальным»,
персонаж при этом стоял на месте. Если нажимать последовательно клавишу W
(«вперед») в определенном римтме, то персонаж совершал комбо из трех ударов,
при этом персонаж двигался вперед как бы наступая на противника. Если нажимать
клавижу S («назад»), то персонаж закрывался мечом и блокировал атаки. В итоге
получалось такое своеобразное фехтование с простыми комбами и блокированием
ударов.

Такое управление было достаточно непривычным и сложным. Вы могли либо бегать,
либо стоять и бить. Вроде бы была ещё возможность совершать одну простую атаку
во время бега. Мне всегда было интересно, что будет, если попробовать сделать
мультиплеер с таким контроллером и устроить дуэль, каково оно будет?

Моя реализация подобного управления возможно будет немного отличаться, ниже
я подробно описываю как именно работает (должен работать) этот контроллер и
какие анимации персонажа потребуются. Предполагается что в этом режиме персонаж
будет экипирован одноручным мечом.

*Примечание*: у меня нет ни подходящих моделек, ни подходящих анимаций, так что
у меня пока не получается полноценно реализовать данный контроллер. Если кто-то
сможет сделать модель персонажей (1 или 2 разных) и соответствующие анимации,
то я попробую сделать мини-игру арену с мультиплеером и этой системой боя.
Связаться со мной можно по электронной почте - shade@shamangrad.net

Как должен работать контроллер
------------------------------

### Состояния персонажа

У персонажа выделяется 3 состояния:
1. мирный (опциональный) - меч находится в ножнах, персонаж не может никого
атаковать в данном режиме. Данный режим может отсутствовать, если игра
предполагает только сражения на арене.
2. боевая готовность - персонаж достал меч и готов к бою, но в этом режиме
он не производит никаких атак и может свободно бегать.
3. боевая стойка - персонаж становиться в боевую стойку, в этом режиме нажатие
клавиш движения будут активировать атаки, так что бегать в этом режиме
невозможно, перемещения возможны только в рамках атак.

### Типы атак и анимации

Персонаж совершает несколько разных типов атак и для каждой из них требуется
своя анимация.
 1. peaceful-idle - персонаж стоит в состоянии ожидания, без оружия
 2. peaceful-walk - персонаж идет спокойным шагом вперед, без оружия
 3. peaceful-run - персонаж бежит вперед, без оружия
 4. peaceful-turning - персонаж разворачивается на месте (не обязательно)
 5. sword-get - персонаж достает меч из ножен, переход из состояния «мирный»,
    в состояние готовности к бою
 6. sword-hide - персонаж прячет меч обратно в ножны, переход из состояния боя
    в состояние «мирный»
 7. sword-idle - персонаж стоит с мечом готовый бою
 8. sword-run - персонаж с мечом бежит вперед
 9. sword-step-left - персонаж с мечом делает шаг влево, движение идет по
    кругу вокруг противника.
10. sword-step-right - персонаж с мечом делает шаг вправо, движение идет по
    кругу вокруг противника.
11. sword-turning - персонаж с мечом разворачивается на месте (не обязательно)
12. sword-stance - персонаж с мечом становиться в усиленную стойку чтобы
    совершать атаки.
13. sword-attack-left - персонаж бьёт мечом слева направо, персонаж при этом
    остается на месте
14. sword-attack-right - персонаж бьёт мечом справа налево, персонаж при этом
    остается на месте
15. sword-attack1, sword-attack2, sword-attack3 - комбо из трех ударов, персонаж
    бьёт мечом прямо, совершая наступательное движение в сторону противника,
	атаки применяются одной клавишей W («вперед»). Если комбо было прервано,
	то новая атака начнется с первой атаки.
16. sword-block - персонаж закрывается мечом (или щитом) от удара.
17. sword-step-back - персонаж отступает на пол шага назад
18. sword-dodge-left - персонаж с мечом делает шаг влево, движение идет по
    кругу вокруг противника. Либо прыжок/кувырок влево.
19. sword-dodge-right - персонаж с мечом делает шаг вправо, движение идет по
    кругу вокруг противника. Либо прыжок/кувырок вправо.

### Управление, захват цели и рефлексы

Переключение из мирного состояния в боевое осуществляется клавишей F «достать
оружие».

В мирном состоянии персонаж двигается свободно как в класическом режиме
клавишами WSAD, камера свободно вращается мышкой вокруг персонажа. Для
свободного вращения камеры вокруг персонажа надо зажать левую кнопку мыши.
Для разворота персонажа мышкой надо зажать правую кнопку мыши или
воспользоваться клавишами разворота Q («разворот влево») и E («разворот
вправо»). Если зажать левую или правую клавиши мыши, то курсор исчезает,
если клавиши мыши отпущены, то курсор мышки появляется и доступен для управления
пользовательским интерфейсом (UI). При нажати клавиш движения (WSAD) персонаж
двигается исходя из текущей ориентации персонажа, т.е. при нажатии W («вперед»),
персонаж будет продолжать вдигаться вперед вне зависимости от ориентации камеры.

В состоянии готовности к бою персонаж управляется также как в мирном режиме,
с небольшими изменениями. Если захвачена цель (противник), то персонаж
автоматически (рефлексы) разворачивается в сторону цели. Чтобы принудительно
развернуть персонажа в другом направлении нужно зажать правую клавишу мыши
или воспользоваться клавишами разворота Q («разворот влево») и E («разворот
вправо»). Если отпустить клавиши разворота (правая кнопка мыши, Q, E), то через
пару мгновений персонаж начнет автоматически (рефлексами) разворачиваться к
выбранной цели. Если противников несколько, то выбранную цель можно изменить
либо щелкнув правой кнопкой мыши по противнику, либо нажимя клавишу TAB.
При нажатии клавиши TAB цель будет переключаться между противниками в области
видимости. У персонажа есть мили-зона (небольшой круг вокруг персонажа на
расстоянии удара), если мили-зоне есть противники, то при нажатии TAB будут
выбираться только противники из мили-зоны. При захвате цели, при нажатии клавиш
A («влево») или D («вправо»), персонаж будет двигаться примерно по кругу
вокруг выбранной цели.

В состоянии боевой стойки обычные передвижения персонажа блокируются, и клавиши
движения будут производить соответствующие атаки. Движение персонажа возможно
только с помощью системы атак, блоков и уворотов. В состоянии боевой стойки
также можно выбирать цель с помощью клавиши TAB и персонаж также будет
рефлексивно разворачиваться в сторону выбранного противника. При атаках, если
выбранная цель находиться на расстоянии удара, то урон будет наноситься
выбранной цели, если цель находиться дальше чем расстояние удара, то урон будет
проходить по ближайшему противнику в области видимости (относительно персонажа).
Если на расстоянии удара нет подходящий противников, то удар будет проходить
впустую (промах).
